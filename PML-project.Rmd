Human Activity Recognition
========================================================

```{r}
library(ggplot2)
library(lattice)
library(caret)
library(rpart)
```

```{r cache=TRUE}
#reading training data set
data<-read.csv("pml-training.csv")
```

```{r}
# discard NA
NAsum <- apply(data,2,function(x) {sum(is.na(x))})
data2 <- data[,which(NAsum==0)]
# discard zeroVar
nsv <- nearZeroVar(data2, saveMetrics=TRUE)
data3 <- data2[,which(nsv$nzv==FALSE)]
# discard unuseful predictors
uPredict <- grep("timestamp|X|user_name|new_window",names(data3))
data5 <- data3[,-uPredict]

ptm <- proc.time()
# training set
#set.seed(12345)
inTrain <- createDataPartition(y = data5$classe, p=0.25,list=FALSE)
training <- data5[inTrain,]
testing <- data5[-inTrain,]
testing2<-testing[sample(nrow(testing),size=dim(training)[1]*2/6),]

# model
modelFit <- train(classe ~., data=training, trControl= trainControl(method = "cv", number = 4), method="rf", prox=TRUE)
modelFit
confusionMatrix(testing2$classe, predict(modelFit,testing2))
# time taken
proc.time() - ptm
```

```{r}
# reading testing data set
dataTest <- read.csv("pml-testing.csv")
dataTestC <- dataTest[,colnames(dataTest) %in% colnames(data5)]
# prediction
predictions2 <- predict(modelFit,newdata=dataTestC)
predictions2
```


